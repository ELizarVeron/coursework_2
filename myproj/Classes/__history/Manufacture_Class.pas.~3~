unit Manufacture_Class;

interface
 uses    System.Generics.Collections, Data.Win.ADODB, System.SysUtils, Vcl.Controls,
  Vcl.Forms, Vcl.Dialogs, Vcl.ComCtrls, Vcl.StdCtrls, Vcl.ExtCtrls,
 Agents, History_Of_Reliz,   Manufacture,
   Supplier,   Main_Class,    Supplier_Class;
type
  TManufacture_Class  = class(TMain_class)
  public
    class var array_of_manufacture: TObjectList<TManufacture>;
           constructor Create();
           class    procedure load_frames(Panel1: TPanel; page, count_in_bd: integer);
           function from_ado_to_array_manufacture(ado: tADOQuery): TObjectList<TManufacture>;
           procedure reload;
           procedure FiltrChange(edit: TEdit; Filtr: TComboBox; sort: TComboBox);
           procedure create_sort(Sortirovka: TComboBox); override;
           procedure create_filter(Filtr: TComboBox); override;

  end;

implementation

{ TManufacture_Class }

constructor TManufacture_Class.Create;
begin
     inherited;
 array_of_manufacture := from_ado_to_array_manufacture(sql_select('*', 'Manufacture','',' order by Id_manufacture ',false));
end;

procedure TManufacture_Class.create_filter(Filtr: TComboBox);
begin


end;

procedure TManufacture_Class.create_sort(Sortirovka: TComboBox);
begin
   Sortirovka.Items.Add(' ↑ По дате создания');
  Sortirovka.Items.Add(' ↓ По дате создания');

end;

procedure TManufacture_Class.FiltrChange(edit: TEdit; Filtr, sort: TComboBox);
begin

end;

function TManufacture_Class.from_ado_to_array_manufacture(
  ado: tADOQuery): TObjectList<TManufacture>;
begin
      var
    manufacture: TManufacture;
    var mc:TMain_Class;
        mc:=TMain_Class.Create;
  var
  array_of_manufacture := TObjectList<TManufacture>.Create;
  while not ado.Eof do
  begin
    manufacture := TManufacture.Create();
    manufacture.ID_Manufacture:= ado.Fields[0].AsInteger;
    manufacture.Login_Master:= ado.Fields[1].AsString;
    manufacture.Id_production:=  ado.Fields[2].AsInteger;
    manufacture.Id_request_from_agent:=ado.Fields[3].AsInteger;
    manufacture.Date_Of_Create:=ado.Fields[4].AsDateTime;
    manufacture.Date_Of_Begin:= ado.Fields[5].AsDateTime;
    manufacture.Date_Of_End:=  ado.Fields[6].AsDateTime;
    manufacture.Status:=  ado.Fields[7].AsString;

    //manufacture.Company:=mc.sql_select('Title', 'Supplier' , 'where ID = ' + req.ID_Sup.ToString,'',false).Fields[0].AsString; //что бы узнать имя по id

    array_of_manufacture.Add(manufacture);
    ado.Next;
  end;
  result := array_of_manufacture;

end;

class procedure TManufacture_Class.load_frames(Panel1: TPanel; page,
  count_in_bd: integer);
begin

end;

procedure TManufacture_Class.reload;
begin

end;

end.
