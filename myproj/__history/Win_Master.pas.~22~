unit Win_Master;

interface
uses
  System.Generics.Collections, Winapi.Windows, Winapi.Messages, System.SysUtils,
  System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.ComCtrls, Vcl.StdCtrls, Data.DB,
  Data.Win.ADODB, Frame_agents, Vcl.ExtCtrls, Vcl.Imaging.jpeg,
  BD_Manager, Agents, Navigator,Main_Class,Product_Class,Supplier_Class,Request_Sup_Class,Material_Class,Frame_manufacture,Manufacture_Class;
type
  TForm3 = class(TForm)
    PageControl1: TPageControl;
    TabSheet1: TTabSheet;
    TabSheet2: TTabSheet;
    TabSheet3: TTabSheet;
    TabSheet4: TTabSheet;
    Navigator_Manufacture: TFrame10;
    Navigator_Req: TFrame10;
    Navigator_Production: TFrame10;
    Panel_manufacture: TPanel;
    Panel_MAterials: TPanel;
    Panel_request_sup: TPanel;
    Panel_production: TPanel;
    PanelUp: TPanel;
    Edit_Agent: TEdit;
    Sort_man: TComboBox;
    Filtr_man: TComboBox;
    Button1: TButton;
    PanelUpReqSup: TPanel;
    Edit1: TEdit;
    ComboBox1: TComboBox;
    ComboBox2: TComboBox;
    ButtonAddRequest: TButton;
    PanelUpProd: TPanel;
    Edit_Prod: TEdit;
    Sort_Prod: TComboBox;
    Filter_prod: TComboBox;
    Button4: TButton;
    Panel1: TPanel;
    Edit2: TEdit;
    ComboBox3: TComboBox;
    ComboBox4: TComboBox;
    Button2: TButton;
    Navigator_Material: TFrame10;
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
      procedure reload_req();
      procedure reload_prod();
  private
    { Private declarations }
  public
     constructor Create(AOwner: TComponent); override;
  end;

  var
  Form3: TForm3;

  ProdClass: TProduct_Class;
  ADO_prod: TADOQuery;
  C_prod: integer;

  ReqClass: TRequest_Sup_Class;
  ADO_req:  TADOQuery;
  C_req: integer;

  MaterClass: TMaterial_Class;
  ADO_mater:  TADOQuery;
  C_mater: integer;

   ManClass: TManufacture_Class;
  ADO_man:  TADOQuery;
  C_man: integer;

implementation

constructor TForm3.Create;
begin
       inherited;

  ProdClass := TProduct_Class.Create;
  C_prod := ProdClass.array_of_products.Count;
  ProdClass.load_frames(Panel_production, 0, C_prod);
  ProdClass.create_sort(Sort_Prod);
  ProdClass.create_filter(filter_prod);
  ProdClass.load_pages(Navigator_Production.Panel2, ProdClass.array_of_products.Count,0);


  ReqClass := TRequest_Sup_Class.Create;
  C_req:= ReqClass.array_of_requests_sup.Count;
  ReqClass.load_frames(Panel_request_sup,0, C_req);
  ReqClass.create_sort(ComboBox1);
  ReqClass.create_filter(ComboBox2);
  ReqClass.load_pages(Navigator_Req.Panel2, ReqClass.array_of_requests_sup.Count,0);


  ManClass := TManufacture_Class.Create;
  C_man:= ManClass.array_of_manufacture.Count;
  ManClass.load_frames(Panel_manufacture,0, C_man);
  ManClass.create_sort(sort_man);
  ManClass.create_filter(Filtr_man);
  ManClass.load_pages(Navigator_Manufacture.Panel2, ManClass.array_of_manufacture.Count,0);

  MaterClass := TMaterial_Class.Create;
  C_mater:= MaterClass.array_of_materials.Count;
  MaterClass.load_frames(Panel_MAterials,0, C_req);
  MaterClass.create_sort(ComboBox3);
  MaterClass.create_filter(ComboBox4);
  MaterClass.load_pages(Navigator_Material.Panel2,MaterClass.array_of_materials.Count,0);
end;





{$R *.dfm}

procedure TForm3.FormClose(Sender: TObject; var Action: TCloseAction);
begin
   application.Terminate;
end;

procedure TForm3.reload_req;
begin
  ReqClass := TRequest_Sup_Class.Create;
  C_req:= ReqClass.array_of_requests_sup.Count;
  ReqClass.load_frames(Panel_request_sup,0, C_req);
  ReqClass.load_pages(Navigator_Req.Panel2, ReqClass.array_of_requests_sup.Count,0);
end;

procedure TForm3.reload_prod();
begin
  ProdClass := TProduct_Class.Create;
  C_prod := ProdClass.array_of_products.Count;
  ProdClass.load_frames(Panel_production, 0, C_prod);
  ProdClass.load_pages(Navigator_Production.Panel2, ProdClass.array_of_products.Count,0);


end;

end.
